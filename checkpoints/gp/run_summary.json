{
  "run_name": "gp_20251017_123045",
  "timestamp": "20251017_123045",
  "optimal_conditions_met": false,
  "training_completed": true,
  "final_step": 425,
  "sparsity_stats": {
    "layer": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      1,
      1,
      1,
      1,
      1,
      1,
      1,
      1,
      1,
      1,
      1,
      1,
      2,
      2,
      2,
      2,
      2,
      2,
      2,
      2,
      2,
      2,
      2,
      2,
      3,
      3,
      3,
      3,
      3,
      3,
      3,
      3,
      3,
      3,
      3,
      3,
      4,
      4,
      4,
      4,
      4,
      4,
      4,
      4,
      4,
      4,
      4,
      4,
      5,
      5,
      5,
      5,
      5,
      5,
      5,
      5,
      5,
      5,
      5,
      5,
      6,
      6,
      6,
      6,
      6,
      6,
      6,
      6,
      6,
      6,
      6,
      6,
      7,
      7,
      7,
      7,
      7,
      7,
      7,
      7,
      7,
      7,
      7,
      7,
      8,
      8,
      8,
      8,
      8,
      8,
      8,
      8,
      8,
      8,
      8,
      8,
      9,
      9,
      9,
      9,
      9,
      9,
      9,
      9,
      9,
      9,
      9,
      9,
      10,
      10,
      10,
      10,
      10,
      10,
      10,
      10,
      10,
      10,
      10,
      10,
      11,
      11,
      11,
      11,
      11,
      11,
      11,
      11,
      11,
      11,
      11,
      11
    ],
    "head": [
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11
    ],
    "qk_sparsity": [
      0.96875,
      0.78125,
      0.953125,
      0.90625,
      0.90625,
      0.96875,
      0.96875,
      0.875,
      0.9375,
      0.90625,
      0.984375,
      0.921875,
      0.859375,
      0.8125,
      0.953125,
      0.90625,
      0.921875,
      0.875,
      0.953125,
      0.84375,
      0.953125,
      0.96875,
      0.96875,
      0.921875,
      0.890625,
      0.8125,
      0.84375,
      0.921875,
      0.890625,
      0.90625,
      0.796875,
      0.96875,
      0.890625,
      0.859375,
      0.921875,
      0.828125,
      0.96875,
      0.90625,
      0.890625,
      0.84375,
      0.953125,
      0.890625,
      0.84375,
      0.859375,
      0.890625,
      0.953125,
      0.8125,
      0.90625,
      0.890625,
      0.921875,
      0.953125,
      0.75,
      0.875,
      0.859375,
      0.859375,
      0.953125,
      0.953125,
      0.84375,
      0.921875,
      0.734375,
      0.84375,
      0.953125,
      0.796875,
      0.953125,
      0.796875,
      0.84375,
      0.9375,
      0.875,
      0.921875,
      0.71875,
      0.8125,
      0.96875,
      0.78125,
      0.9375,
      0.9375,
      0.90625,
      0.9375,
      0.828125,
      0.9375,
      0.921875,
      0.984375,
      0.984375,
      0.890625,
      0.90625,
      0.921875,
      0.71875,
      0.984375,
      0.921875,
      0.90625,
      0.90625,
      0.953125,
      0.921875,
      0.921875,
      0.828125,
      1.0,
      0.96875,
      1.0,
      0.96875,
      0.96875,
      0.953125,
      0.984375,
      0.953125,
      0.953125,
      0.96875,
      0.96875,
      0.9375,
      0.9375,
      0.84375,
      0.984375,
      0.984375,
      0.96875,
      0.984375,
      0.921875,
      0.921875,
      0.984375,
      0.46875,
      0.984375,
      0.984375,
      0.953125,
      1.0,
      1.0,
      1.0,
      1.0,
      0.984375,
      1.0,
      0.984375,
      0.984375,
      1.0,
      0.984375,
      0.5,
      1.0,
      1.0,
      0.96875,
      0.671875,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      0.953125,
      0.8125,
      1.0,
      1.0,
      1.0
    ],
    "ov_sparsity": [
      1.0,
      1.0,
      1.0,
      0.9846153855323792,
      1.0,
      1.0,
      1.0,
      1.0,
      0.9846153855323792,
      0.9846153855323792,
      0.9846153855323792,
      0.9846153855323792,
      1.0,
      1.0,
      1.0,
      1.0,
      0.9538461565971375,
      1.0,
      1.0,
      1.0,
      1.0,
      0.9846153855323792,
      1.0,
      1.0,
      1.0,
      0.9846153855323792,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      0.9692307710647583,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      0.9538461565971375,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      0.9384615421295166,
      0.9846153855323792,
      1.0,
      0.9846153855323792,
      1.0,
      1.0,
      0.9846153855323792,
      1.0,
      0.892307698726654,
      1.0,
      0.8307692408561707,
      0.9692307710647583,
      1.0,
      0.7846153974533081,
      0.9846153855323792,
      0.9846153855323792,
      1.0,
      0.9230769276618958,
      1.0,
      1.0,
      1.0,
      1.0,
      0.9538461565971375,
      0.9230769276618958,
      0.9846153855323792,
      0.9692307710647583,
      0.9230769276618958,
      0.8461538553237915,
      0.9846153855323792,
      0.892307698726654,
      0.9230769276618958,
      0.9384615421295166,
      1.0,
      1.0,
      0.9846153855323792,
      0.9384615421295166,
      0.9538461565971375,
      0.8461538553237915,
      1.0,
      0.8153846263885498,
      0.9538461565971375,
      0.9692307710647583,
      0.9538461565971375,
      0.9384615421295166,
      0.9384615421295166,
      0.9692307710647583,
      1.0,
      1.0,
      1.0,
      0.9846153855323792,
      0.8307692408561707,
      0.9384615421295166,
      1.0,
      0.9230769276618958,
      0.9846153855323792,
      1.0,
      0.9846153855323792,
      0.9692307710647583,
      1.0,
      1.0,
      0.9846153855323792,
      1.0,
      1.0,
      0.8153846263885498,
      1.0,
      1.0,
      0.9692307710647583,
      0.7076923251152039,
      0.9846153855323792,
      1.0,
      0.9538461565971375,
      0.6153846383094788,
      0.9846153855323792,
      0.9538461565971375,
      0.9692307710647583,
      0.9384615421295166,
      0.9846153855323792,
      0.7076923251152039,
      0.6615384817123413,
      1.0,
      0.9846153855323792,
      0.9846153855323792
    ],
    "overall_sparsity": [
      0.984375,
      0.890625,
      0.9765625,
      0.9454326927661896,
      0.953125,
      0.984375,
      0.984375,
      0.9375,
      0.9610576927661896,
      0.9454326927661896,
      0.9844951927661896,
      0.9532451927661896,
      0.9296875,
      0.90625,
      0.9765625,
      0.953125,
      0.9378605782985687,
      0.9375,
      0.9765625,
      0.921875,
      0.9765625,
      0.9766826927661896,
      0.984375,
      0.9609375,
      0.9453125,
      0.8985576927661896,
      0.921875,
      0.9609375,
      0.9453125,
      0.953125,
      0.8984375,
      0.984375,
      0.9453125,
      0.9296875,
      0.9609375,
      0.9140625,
      0.984375,
      0.953125,
      0.9453125,
      0.921875,
      0.9765625,
      0.9299278855323792,
      0.921875,
      0.9296875,
      0.9453125,
      0.9765625,
      0.90625,
      0.953125,
      0.9453125,
      0.9609375,
      0.9765625,
      0.8519230782985687,
      0.9375,
      0.9296875,
      0.9296875,
      0.9765625,
      0.9765625,
      0.921875,
      0.9609375,
      0.8671875,
      0.921875,
      0.9765625,
      0.8676682710647583,
      0.9688701927661896,
      0.8984375,
      0.9141826927661896,
      0.96875,
      0.9375,
      0.9532451927661896,
      0.859375,
      0.852403849363327,
      0.984375,
      0.8060096204280853,
      0.9533653855323792,
      0.96875,
      0.845432698726654,
      0.9610576927661896,
      0.9063701927661896,
      0.96875,
      0.9224759638309479,
      0.9921875,
      0.9921875,
      0.9453125,
      0.953125,
      0.9378605782985687,
      0.8209134638309479,
      0.9844951927661896,
      0.9455528855323792,
      0.9146634638309479,
      0.8762019276618958,
      0.9688701927661896,
      0.907091349363327,
      0.9224759638309479,
      0.8832932710647583,
      1.0,
      0.984375,
      0.9923076927661896,
      0.9536057710647583,
      0.9612980782985687,
      0.8996394276618958,
      0.9921875,
      0.8842548131942749,
      0.9534855782985687,
      0.9689903855323792,
      0.9612980782985687,
      0.9379807710647583,
      0.9379807710647583,
      0.9064903855323792,
      0.9921875,
      0.9921875,
      0.984375,
      0.9844951927661896,
      0.8763221204280853,
      0.9301682710647583,
      0.9921875,
      0.6959134638309479,
      0.9844951927661896,
      0.9921875,
      0.9688701927661896,
      0.9846153855323792,
      1.0,
      1.0,
      0.9923076927661896,
      0.9921875,
      1.0,
      0.8998798131942749,
      0.9921875,
      1.0,
      0.9768028855323792,
      0.6038461625576019,
      0.9923076927661896,
      1.0,
      0.9612980782985687,
      0.6436298191547394,
      0.9923076927661896,
      0.9769230782985687,
      0.9846153855323792,
      0.9692307710647583,
      0.9923076927661896,
      0.8304086625576019,
      0.7370192408561707,
      1.0,
      0.9923076927661896,
      0.9923076927661896
    ],
    "mlp_in_sparsity": [
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      0.9960988163948059,
      0.981794536113739,
      0.9882965087890625,
      0.9908972978591919,
      0.9492847919464111,
      0.9245773553848267
    ],
    "mlp_out_sparsity": [
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      0.99609375,
      0.98046875,
      0.9908854365348816,
      0.9921875,
      0.9817708134651184,
      0.9166666865348816
    ],
    "total_sparsity": 0.9639924365207996
  },
  "sparsity_metrics": {
    "num_active_components": 1151,
    "relative_sparsity": 0.9689086980010805,
    "full_sparsity": 0.9951996062926447,
    "relative_sparsity_pct": 96.89086980010805,
    "full_sparsity_pct": 99.51996062926447,
    "relative_denominator": 37020,
    "full_denominator": 239772,
    "sparsity_threshold": 0.01
  },
  "hyperparameters": {
    "learning_rate": 0.01,
    "l1_weight": 0.00015,
    "weight_decay": 0.0,
    "batch_size": 64,
    "num_epochs": 25,
    "sparsity_threshold": 0.01
  },
  "config": {
    "experiment_name": "gp",
    "seed": 42,
    "use_wandb": true,
    "model": {
      "name": "gpt2-small",
      "pretrained_cache_dir": "cache_dir"
    },
    "data_type": "gp",
    "max_pad_length": 64,
    "training": {
      "batch_size": 64,
      "num_epochs": 25,
      "device": "cuda",
      "learning_rate": 0.01,
      "weight_decay": 0.0,
      "l1_weight": 0.00015,
      "temperature": 1.0,
      "eval_interval": 50,
      "patience": 5,
      "min_lr": "1e-6",
      "lr_factor": 0.5,
      "early_stopping": true,
      "save_checkpoints": true,
      "annealing_lambda_epochs": -1,
      "kl_opt": 0.1,
      "l1_opt": 3500,
      "validation_interval": 20
    },
    "masking": {
      "mask_init_value": 0.99,
      "cache_svd": true,
      "warmup_steps": 0,
      "max_iterations_per_batch": 15,
      "sparsity_threshold": 0.01,
      "sparsity": {
        "initial": 0.0,
        "target": 0.85,
        "increment": 0.01,
        "steps": 500
      },
      "regularization": {
        "kl_coefficient": 1.0
      }
    },
    "visualization": {
      "plot_interval": 100,
      "log_gradients": false,
      "save_visualizations": true,
      "visualization_dir": "visualizations"
    },
    "log_dir": "svd_circuit_logs_/\"gp\"_bayesopt",
    "run_dir": "svd_logs/gp_20251017_123045",
    "vis_dir": "svd_logs/gp_20251017_123045/visualizations"
  },
  "validation_kl": 0.1350169082482656,
  "validation_loss": 0.24103516340255737,
  "l1_norm": 706.788330078125,
  "masked_accuracy": 0.7592147588729858,
  "full_model_accuracy": 0.7956730922063192,
  "exact_match": 0.8705929517745972,
  "kl_threshold": 0.1,
  "l1_threshold": 3500,
  "test_evaluation": {
    "test_kl": 0.12715968489646912,
    "test_kl_std": 0.01472194983191413,
    "test_loss": 0.12715968489646912,
    "test_masked_acc": 0.7559999942779541,
    "test_masked_acc_std": 0.05084688756789276,
    "test_full_acc": 0.7724999904632568,
    "test_full_acc_std": 0.043002537430708546,
    "test_exact_match": 0.8661249995231628,
    "test_exact_match_std": 0.07417925875571493
  }
}