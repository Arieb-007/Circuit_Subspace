{
  "run_name": "GP_20251023_012746",
  "timestamp": "20251023_012746",
  "optimal_conditions_met": false,
  "training_completed": true,
  "final_step": 255,
  "sparsity_stats": {
    "layer": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      1,
      1,
      1,
      1,
      1,
      1,
      1,
      1,
      1,
      1,
      1,
      1,
      2,
      2,
      2,
      2,
      2,
      2,
      2,
      2,
      2,
      2,
      2,
      2,
      3,
      3,
      3,
      3,
      3,
      3,
      3,
      3,
      3,
      3,
      3,
      3,
      4,
      4,
      4,
      4,
      4,
      4,
      4,
      4,
      4,
      4,
      4,
      4,
      5,
      5,
      5,
      5,
      5,
      5,
      5,
      5,
      5,
      5,
      5,
      5,
      6,
      6,
      6,
      6,
      6,
      6,
      6,
      6,
      6,
      6,
      6,
      6,
      7,
      7,
      7,
      7,
      7,
      7,
      7,
      7,
      7,
      7,
      7,
      7,
      8,
      8,
      8,
      8,
      8,
      8,
      8,
      8,
      8,
      8,
      8,
      8,
      9,
      9,
      9,
      9,
      9,
      9,
      9,
      9,
      9,
      9,
      9,
      9,
      10,
      10,
      10,
      10,
      10,
      10,
      10,
      10,
      10,
      10,
      10,
      10,
      11,
      11,
      11,
      11,
      11,
      11,
      11,
      11,
      11,
      11,
      11,
      11
    ],
    "head": [
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11
    ],
    "qk_sparsity": [
      0.96875,
      0.765625,
      0.953125,
      0.921875,
      0.84375,
      0.96875,
      0.953125,
      0.828125,
      0.9375,
      0.90625,
      0.96875,
      0.90625,
      0.84375,
      0.796875,
      0.9375,
      0.90625,
      0.921875,
      0.875,
      0.953125,
      0.84375,
      0.921875,
      0.953125,
      0.96875,
      0.890625,
      0.84375,
      0.8125,
      0.8125,
      0.859375,
      0.890625,
      0.859375,
      0.765625,
      0.9375,
      0.859375,
      0.84375,
      0.890625,
      0.75,
      0.984375,
      0.875,
      0.90625,
      0.8125,
      0.9375,
      0.875,
      0.78125,
      0.859375,
      0.84375,
      0.921875,
      0.78125,
      0.859375,
      0.890625,
      0.90625,
      0.96875,
      0.703125,
      0.859375,
      0.828125,
      0.859375,
      0.9375,
      0.96875,
      0.796875,
      0.921875,
      0.703125,
      0.84375,
      0.953125,
      0.71875,
      0.921875,
      0.796875,
      0.875,
      0.921875,
      0.890625,
      0.9375,
      0.71875,
      0.765625,
      0.96875,
      0.703125,
      0.90625,
      0.9375,
      0.84375,
      0.890625,
      0.828125,
      0.921875,
      0.890625,
      0.984375,
      0.96875,
      0.90625,
      0.90625,
      0.921875,
      0.6875,
      0.96875,
      0.90625,
      0.921875,
      0.890625,
      0.953125,
      0.9375,
      0.890625,
      0.78125,
      1.0,
      0.984375,
      0.96875,
      0.96875,
      0.96875,
      0.9375,
      0.984375,
      0.9375,
      0.953125,
      0.96875,
      0.9375,
      0.921875,
      0.90625,
      0.78125,
      0.984375,
      0.984375,
      0.9375,
      0.984375,
      0.875,
      0.875,
      0.984375,
      0.375,
      0.984375,
      0.984375,
      0.953125,
      1.0,
      1.0,
      0.984375,
      0.984375,
      0.984375,
      1.0,
      0.984375,
      0.984375,
      1.0,
      0.984375,
      0.46875,
      0.984375,
      1.0,
      0.984375,
      0.671875,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      0.921875,
      0.796875,
      1.0,
      1.0,
      1.0
    ],
    "ov_sparsity": [
      1.0,
      1.0,
      1.0,
      0.9846153855323792,
      1.0,
      1.0,
      0.9846153855323792,
      1.0,
      0.9846153855323792,
      0.9846153855323792,
      0.9846153855323792,
      0.9846153855323792,
      1.0,
      1.0,
      1.0,
      1.0,
      0.9538461565971375,
      1.0,
      1.0,
      1.0,
      0.9692307710647583,
      0.9846153855323792,
      1.0,
      1.0,
      1.0,
      0.9846153855323792,
      1.0,
      1.0,
      1.0,
      1.0,
      0.9846153855323792,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      0.9692307710647583,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      0.9538461565971375,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      0.9846153855323792,
      1.0,
      0.9384615421295166,
      0.9846153855323792,
      1.0,
      0.9692307710647583,
      1.0,
      1.0,
      1.0,
      1.0,
      0.9076923131942749,
      1.0,
      0.8307692408561707,
      0.9692307710647583,
      0.9846153855323792,
      0.7538461685180664,
      0.9846153855323792,
      0.9846153855323792,
      1.0,
      0.9230769276618958,
      1.0,
      1.0,
      1.0,
      1.0,
      0.9538461565971375,
      0.9076923131942749,
      0.9692307710647583,
      0.9538461565971375,
      0.8461538553237915,
      0.8461538553237915,
      1.0,
      0.892307698726654,
      0.9230769276618958,
      0.9230769276618958,
      1.0,
      1.0,
      0.9846153855323792,
      0.9384615421295166,
      0.9384615421295166,
      0.8153846263885498,
      1.0,
      0.8307692408561707,
      0.9230769276618958,
      0.9846153855323792,
      0.9384615421295166,
      0.9076923131942749,
      0.8615384697914124,
      0.9692307710647583,
      1.0,
      0.9692307710647583,
      1.0,
      0.9846153855323792,
      0.800000011920929,
      0.9076923131942749,
      1.0,
      0.9230769276618958,
      0.9846153855323792,
      1.0,
      0.9846153855323792,
      0.9692307710647583,
      1.0,
      1.0,
      0.9846153855323792,
      1.0,
      1.0,
      0.7692307829856873,
      1.0,
      1.0,
      0.9384615421295166,
      0.7076923251152039,
      0.9846153855323792,
      1.0,
      0.9692307710647583,
      0.6153846383094788,
      0.9846153855323792,
      0.9692307710647583,
      0.9846153855323792,
      0.9230769276618958,
      0.9692307710647583,
      0.6615384817123413,
      0.6769230961799622,
      0.9692307710647583,
      0.9846153855323792,
      0.9846153855323792
    ],
    "overall_sparsity": [
      0.984375,
      0.8828125,
      0.9765625,
      0.9532451927661896,
      0.921875,
      0.984375,
      0.9688701927661896,
      0.9140625,
      0.9610576927661896,
      0.9454326927661896,
      0.9766826927661896,
      0.9454326927661896,
      0.921875,
      0.8984375,
      0.96875,
      0.953125,
      0.9378605782985687,
      0.9375,
      0.9765625,
      0.921875,
      0.9455528855323792,
      0.9688701927661896,
      0.984375,
      0.9453125,
      0.921875,
      0.8985576927661896,
      0.90625,
      0.9296875,
      0.9453125,
      0.9296875,
      0.8751201927661896,
      0.96875,
      0.9296875,
      0.921875,
      0.9453125,
      0.875,
      0.9921875,
      0.9375,
      0.953125,
      0.90625,
      0.96875,
      0.9221153855323792,
      0.890625,
      0.9296875,
      0.921875,
      0.9609375,
      0.890625,
      0.9296875,
      0.9453125,
      0.953125,
      0.984375,
      0.8284855782985687,
      0.9296875,
      0.9140625,
      0.9296875,
      0.96875,
      0.984375,
      0.8984375,
      0.9609375,
      0.8515625,
      0.9141826927661896,
      0.9765625,
      0.8286057710647583,
      0.9532451927661896,
      0.8984375,
      0.9221153855323792,
      0.9609375,
      0.9453125,
      0.96875,
      0.859375,
      0.8366586565971375,
      0.984375,
      0.7669471204280853,
      0.9377403855323792,
      0.9610576927661896,
      0.7987980842590332,
      0.9376201927661896,
      0.9063701927661896,
      0.9609375,
      0.9068509638309479,
      0.9921875,
      0.984375,
      0.953125,
      0.953125,
      0.9378605782985687,
      0.7975961565971375,
      0.9689903855323792,
      0.9300480782985687,
      0.8840144276618958,
      0.8683894276618958,
      0.9765625,
      0.914903849363327,
      0.9068509638309479,
      0.8521634638309479,
      1.0,
      0.9921875,
      0.9766826927661896,
      0.9536057710647583,
      0.9536057710647583,
      0.8764423131942749,
      0.9921875,
      0.8841346204280853,
      0.9381009638309479,
      0.9766826927661896,
      0.9379807710647583,
      0.9147836565971375,
      0.8838942348957062,
      0.8752403855323792,
      0.9921875,
      0.9768028855323792,
      0.96875,
      0.9844951927661896,
      0.8375000059604645,
      0.8913461565971375,
      0.9921875,
      0.6490384638309479,
      0.9844951927661896,
      0.9921875,
      0.9688701927661896,
      0.9846153855323792,
      1.0,
      0.9921875,
      0.9844951927661896,
      0.9921875,
      1.0,
      0.8768028914928436,
      0.9921875,
      1.0,
      0.9614182710647583,
      0.5882211625576019,
      0.9844951927661896,
      1.0,
      0.9768028855323792,
      0.6436298191547394,
      0.9923076927661896,
      0.9846153855323792,
      0.9923076927661896,
      0.9615384638309479,
      0.9846153855323792,
      0.7917067408561707,
      0.7368990480899811,
      0.9846153855323792,
      0.9923076927661896,
      0.9923076927661896
    ],
    "mlp_in_sparsity": [
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      0.9960988163948059,
      0.981794536113739,
      0.9882965087890625,
      0.9908972978591919,
      0.9479843974113464,
      0.9258777499198914
    ],
    "mlp_out_sparsity": [
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      0.99609375,
      0.9817708134651184,
      0.9921875,
      0.9934895634651184,
      0.9817708134651184,
      0.9127604365348816
    ],
    "total_sparsity": 0.9591842247433819
  },
  "sparsity_metrics": {
    "num_active_components": 1182,
    "relative_sparsity": 0.9680713128038898,
    "full_sparsity": 0.9950703168009609,
    "relative_sparsity_pct": 96.80713128038899,
    "full_sparsity_pct": 99.50703168009609,
    "relative_denominator": 37020,
    "full_denominator": 239772,
    "sparsity_threshold": 0.01
  },
  "hyperparameters": {
    "learning_rate": 0.01,
    "l1_weight": 0.00019,
    "weight_decay": 0.0,
    "batch_size": 64,
    "num_epochs": 15,
    "sparsity_threshold": 0.01
  },
  "config": {
    "experiment_name": "GP",
    "seed": 42,
    "use_wandb": true,
    "model": {
      "name": "gpt2-small",
      "pretrained_cache_dir": "cache_dir"
    },
    "data_type": "gp",
    "max_pad_length": 64,
    "training": {
      "batch_size": 64,
      "num_epochs": 15,
      "device": "cuda",
      "learning_rate": 0.01,
      "weight_decay": 0.0,
      "l1_weight": 0.00019,
      "temperature": 1.0,
      "eval_interval": 50,
      "patience": 5,
      "min_lr": "1e-6",
      "lr_factor": 0.5,
      "early_stopping": true,
      "save_checkpoints": true,
      "annealing_lambda_epochs": -1,
      "kl_opt": 0.1,
      "l1_opt": 3500,
      "validation_interval": 20
    },
    "masking": {
      "mask_init_value": 0.99,
      "cache_svd": true,
      "warmup_steps": 0,
      "max_iterations_per_batch": 15,
      "sparsity_threshold": 0.01,
      "sparsity": {
        "initial": 0.0,
        "target": 0.85,
        "increment": 0.01,
        "steps": 500
      },
      "regularization": {
        "kl_coefficient": 1.0
      }
    },
    "visualization": {
      "plot_interval": 100,
      "log_gradients": false,
      "save_visualizations": true,
      "visualization_dir": "visualizations"
    },
    "log_dir": "svd_circuit_logs_/\"gp\"_bayesopt",
    "run_dir": "svd_logs/GP_20251023_012746",
    "vis_dir": "svd_logs/GP_20251023_012746/visualizations"
  },
  "validation_kl": 0.1371520236134529,
  "validation_loss": 0.2638070583343506,
  "l1_norm": 666.6052856445312,
  "masked_accuracy": 0.7668269276618958,
  "full_model_accuracy": 0.8413461645444235,
  "exact_match": 0.8605769276618958,
  "kl_threshold": 0.1,
  "l1_threshold": 3500,
  "test_evaluation": {
    "test_kl": 0.13481118977069856,
    "test_kl_std": 0.010786143561589223,
    "test_loss": 0.13481118977069856,
    "test_masked_acc": 0.7528749942779541,
    "test_masked_acc_std": 0.043367250772664165,
    "test_full_acc": 0.7724999904632568,
    "test_full_acc_std": 0.043002537430708546,
    "test_exact_match": 0.8629999995231629,
    "test_exact_match_std": 0.07138298940620993,
    "test_logit_diff": 2.4598875522613524,
    "test_logit_diff_std": 0.24836181454902895,
    "relative_sparsity": 96.80713128038899,
    "full_sparsity": 99.50703168009609,
    "num_active_components": 1182,
    "epoch": 255,
    "step": 255
  }
}