{
  "run_name": "IOI_20251022_213530",
  "timestamp": "20251022_213530",
  "optimal_conditions_met": false,
  "training_completed": true,
  "final_step": 176,
  "sparsity_stats": {
    "layer": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      1,
      1,
      1,
      1,
      1,
      1,
      1,
      1,
      1,
      1,
      1,
      1,
      2,
      2,
      2,
      2,
      2,
      2,
      2,
      2,
      2,
      2,
      2,
      2,
      3,
      3,
      3,
      3,
      3,
      3,
      3,
      3,
      3,
      3,
      3,
      3,
      4,
      4,
      4,
      4,
      4,
      4,
      4,
      4,
      4,
      4,
      4,
      4,
      5,
      5,
      5,
      5,
      5,
      5,
      5,
      5,
      5,
      5,
      5,
      5,
      6,
      6,
      6,
      6,
      6,
      6,
      6,
      6,
      6,
      6,
      6,
      6,
      7,
      7,
      7,
      7,
      7,
      7,
      7,
      7,
      7,
      7,
      7,
      7,
      8,
      8,
      8,
      8,
      8,
      8,
      8,
      8,
      8,
      8,
      8,
      8,
      9,
      9,
      9,
      9,
      9,
      9,
      9,
      9,
      9,
      9,
      9,
      9,
      10,
      10,
      10,
      10,
      10,
      10,
      10,
      10,
      10,
      10,
      10,
      10,
      11,
      11,
      11,
      11,
      11,
      11,
      11,
      11,
      11,
      11,
      11,
      11
    ],
    "head": [
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11
    ],
    "qk_sparsity": [
      0.890625,
      0.0625,
      0.828125,
      0.484375,
      0.484375,
      0.03125,
      0.71875,
      0.8125,
      0.875,
      0.625,
      0.5,
      0.875,
      0.78125,
      0.6875,
      0.984375,
      0.890625,
      0.921875,
      0.90625,
      0.875,
      0.8125,
      0.90625,
      0.9375,
      0.96875,
      0.59375,
      0.78125,
      0.8125,
      0.546875,
      0.84375,
      0.90625,
      0.703125,
      0.6875,
      0.9375,
      0.828125,
      0.6875,
      0.875,
      0.65625,
      0.015625,
      0.828125,
      0.671875,
      0.625,
      0.609375,
      0.84375,
      0.796875,
      0.671875,
      0.828125,
      0.875,
      0.78125,
      0.828125,
      0.828125,
      0.90625,
      0.953125,
      0.65625,
      0.640625,
      0.546875,
      0.6875,
      0.96875,
      0.828125,
      0.8125,
      0.90625,
      0.265625,
      0.609375,
      0.9375,
      0.796875,
      0.921875,
      0.59375,
      0.140625,
      0.921875,
      0.9375,
      0.296875,
      0.15625,
      0.65625,
      0.921875,
      0.734375,
      0.75,
      0.875,
      0.921875,
      0.84375,
      0.796875,
      0.609375,
      0.796875,
      0.78125,
      0.328125,
      0.796875,
      0.90625,
      0.84375,
      0.5625,
      0.984375,
      0.625,
      0.90625,
      0.78125,
      0.859375,
      0.96875,
      0.875,
      0.5,
      0.984375,
      0.984375,
      0.890625,
      0.984375,
      0.9375,
      0.53125,
      0.953125,
      0.78125,
      0.4375,
      0.96875,
      0.875,
      0.828125,
      0.546875,
      0.875,
      0.84375,
      0.984375,
      0.921875,
      0.890625,
      0.46875,
      0.71875,
      0.515625,
      0.59375,
      0.703125,
      0.265625,
      0.9375,
      0.984375,
      0.203125,
      0.65625,
      0.390625,
      0.90625,
      0.921875,
      0.953125,
      0.625,
      0.0625,
      0.734375,
      0.78125,
      0.34375,
      0.984375,
      0.96875,
      0.59375,
      0.046875,
      0.75,
      0.625,
      1.0,
      0.109375,
      1.0,
      0.96875,
      0.828125,
      0.03125,
      0.90625
    ],
    "ov_sparsity": [
      1.0,
      0.9846153855323792,
      0.9846153855323792,
      1.0,
      1.0,
      1.0,
      0.9692307710647583,
      1.0,
      0.9846153855323792,
      1.0,
      1.0,
      0.9846153855323792,
      1.0,
      1.0,
      0.9846153855323792,
      0.9846153855323792,
      0.9692307710647583,
      0.9692307710647583,
      1.0,
      0.9692307710647583,
      0.9384615421295166,
      0.9538461565971375,
      0.9692307710647583,
      0.9692307710647583,
      1.0,
      0.9692307710647583,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      0.9692307710647583,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      0.9846153855323792,
      1.0,
      0.9846153855323792,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      0.9538461565971375,
      0.9692307710647583,
      1.0,
      0.9538461565971375,
      1.0,
      0.9846153855323792,
      1.0,
      1.0,
      1.0,
      1.0,
      0.9846153855323792,
      1.0,
      0.9846153855323792,
      1.0,
      0.892307698726654,
      1.0,
      1.0,
      0.9846153855323792,
      0.9692307710647583,
      0.9384615421295166,
      0.9846153855323792,
      0.9692307710647583,
      0.9384615421295166,
      0.9384615421295166,
      0.9846153855323792,
      0.9538461565971375,
      1.0,
      0.8769230842590332,
      0.8769230842590332,
      0.9846153855323792,
      0.9692307710647583,
      0.9076923131942749,
      0.9846153855323792,
      0.9692307710647583,
      0.9538461565971375,
      1.0,
      0.4307692348957062,
      0.9692307710647583,
      0.9538461565971375,
      0.9076923131942749,
      1.0,
      1.0,
      0.1538461595773697,
      1.0,
      1.0,
      0.9538461565971375,
      1.0,
      0.8153846263885498,
      0.4615384638309479,
      0.9846153855323792,
      0.6769230961799622,
      0.29230770468711853,
      0.9846153855323792,
      0.9846153855323792,
      0.9538461565971375,
      0.2461538463830948,
      0.9692307710647583,
      0.9692307710647583,
      1.0,
      0.9846153855323792,
      0.800000011920929,
      0.6461538672447205,
      0.6307692527770996,
      0.015384615398943424,
      0.5846154093742371,
      0.29230770468711853,
      0.015384615398943424,
      1.0,
      0.9846153855323792,
      0.015384615398943424,
      0.0923076942563057,
      0.04615384712815285,
      0.6769230961799622,
      0.9384615421295166,
      0.9076923131942749,
      0.03076923079788685,
      0.10769230872392654,
      0.4153846204280853,
      0.9076923131942749,
      0.015384615398943424,
      0.9846153855323792,
      0.892307698726654,
      0.1846153885126114,
      0.015384615398943424,
      0.015384615398943424,
      0.3384615480899811,
      0.8615384697914124,
      0.015384615398943424,
      0.7538461685180664,
      0.7230769395828247,
      0.015384615398943424,
      0.07692307978868484,
      0.4923076927661896
    ],
    "overall_sparsity": [
      0.9453125,
      0.5235576927661896,
      0.9063701927661896,
      0.7421875,
      0.7421875,
      0.515625,
      0.8439903855323792,
      0.90625,
      0.9298076927661896,
      0.8125,
      0.75,
      0.9298076927661896,
      0.890625,
      0.84375,
      0.9844951927661896,
      0.9376201927661896,
      0.9455528855323792,
      0.9377403855323792,
      0.9375,
      0.8908653855323792,
      0.9223557710647583,
      0.9456730782985687,
      0.9689903855323792,
      0.7814903855323792,
      0.890625,
      0.8908653855323792,
      0.7734375,
      0.921875,
      0.953125,
      0.8515625,
      0.84375,
      0.96875,
      0.9140625,
      0.84375,
      0.9375,
      0.8127403855323792,
      0.5078125,
      0.9140625,
      0.8359375,
      0.8125,
      0.8046875,
      0.921875,
      0.8984375,
      0.8282451927661896,
      0.9140625,
      0.9298076927661896,
      0.890625,
      0.9140625,
      0.9140625,
      0.953125,
      0.9765625,
      0.8050480782985687,
      0.8049278855323792,
      0.7734375,
      0.8206730782985687,
      0.984375,
      0.9063701927661896,
      0.90625,
      0.953125,
      0.6328125,
      0.8046875,
      0.9610576927661896,
      0.8984375,
      0.9532451927661896,
      0.796875,
      0.516466349363327,
      0.9609375,
      0.96875,
      0.6407451927661896,
      0.5627403855323792,
      0.7973557710647583,
      0.9532451927661896,
      0.8518028855323792,
      0.8442307710647583,
      0.9067307710647583,
      0.9532451927661896,
      0.8987980782985687,
      0.8984375,
      0.7431490421295166,
      0.8368990421295166,
      0.8829326927661896,
      0.6486778855323792,
      0.8522836565971375,
      0.9454326927661896,
      0.9064903855323792,
      0.7581730782985687,
      0.9921875,
      0.5278846174478531,
      0.9377403855323792,
      0.8675480782985687,
      0.8835336565971375,
      0.984375,
      0.9375,
      0.32692307978868484,
      0.9921875,
      0.9921875,
      0.9222355782985687,
      0.9921875,
      0.8764423131942749,
      0.49639423191547394,
      0.9688701927661896,
      0.7290865480899811,
      0.36490385234355927,
      0.9766826927661896,
      0.9298076927661896,
      0.8909855782985687,
      0.3965144231915474,
      0.9221153855323792,
      0.9064903855323792,
      0.9921875,
      0.9532451927661896,
      0.8453125059604645,
      0.5574519336223602,
      0.6747596263885498,
      0.2655048076994717,
      0.5891827046871185,
      0.49771635234355927,
      0.1405048076994717,
      0.96875,
      0.9844951927661896,
      0.10925480769947171,
      0.37427884712815285,
      0.21838942356407642,
      0.7915865480899811,
      0.9301682710647583,
      0.9304086565971375,
      0.3278846153989434,
      0.08509615436196327,
      0.5748798102140427,
      0.8444711565971375,
      0.1795673076994717,
      0.9844951927661896,
      0.930528849363327,
      0.3891826942563057,
      0.031129807699471712,
      0.3826923076994717,
      0.48173077404499054,
      0.9307692348957062,
      0.06237980769947171,
      0.8769230842590332,
      0.8459134697914124,
      0.4217548076994717,
      0.05408653989434242,
      0.6992788463830948
    ],
    "mlp_in_sparsity": [
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      0.9947984218597412,
      0.9882965087890625,
      0.9622886776924133
    ],
    "mlp_out_sparsity": [
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      0.99609375,
      0.99609375,
      0.9934895634651184
    ],
    "total_sparsity": 0.8880334954078877
  },
  "sparsity_metrics": {
    "num_active_components": 3213,
    "relative_sparsity": 0.9132090761750405,
    "full_sparsity": 0.9865997697812923,
    "relative_sparsity_pct": 91.32090761750405,
    "full_sparsity_pct": 98.65997697812922,
    "relative_denominator": 37020,
    "full_denominator": 239772,
    "sparsity_threshold": 0.01
  },
  "hyperparameters": {
    "learning_rate": 0.01,
    "l1_weight": 0.00018,
    "weight_decay": 0.0,
    "batch_size": 64,
    "num_epochs": 11,
    "sparsity_threshold": 0.01
  },
  "config": {
    "experiment_name": "IOI",
    "seed": 42,
    "use_wandb": true,
    "model": {
      "name": "gpt2-small",
      "pretrained_cache_dir": "cache_dir"
    },
    "data_type": "ioi",
    "max_pad_length": 64,
    "training": {
      "batch_size": 64,
      "num_epochs": 11,
      "device": "cuda",
      "learning_rate": 0.01,
      "weight_decay": 0.0,
      "l1_weight": 0.00018,
      "temperature": 1.0,
      "eval_interval": 50,
      "patience": 5,
      "min_lr": "1e-6",
      "lr_factor": 0.5,
      "early_stopping": true,
      "save_checkpoints": true,
      "annealing_lambda_epochs": -1,
      "kl_opt": 0.1,
      "l1_opt": 3500,
      "validation_interval": 20
    },
    "masking": {
      "mask_init_value": 0.99,
      "cache_svd": true,
      "warmup_steps": 0,
      "max_iterations_per_batch": 15,
      "sparsity_threshold": 0.01,
      "sparsity": {
        "initial": 0.0,
        "target": 0.85,
        "increment": 0.01,
        "steps": 500
      },
      "regularization": {
        "kl_coefficient": 1.0
      }
    },
    "visualization": {
      "plot_interval": 100,
      "log_gradients": false,
      "save_visualizations": true,
      "visualization_dir": "visualizations"
    },
    "log_dir": "svd_circuit_logs_/\"ioi\"_bayesopt",
    "run_dir": "svd_logs/IOI_20251022_213530",
    "vis_dir": "svd_logs/IOI_20251022_213530/visualizations"
  },
  "validation_kl": 0.24397462978959084,
  "validation_loss": 0.48820483684539795,
  "l1_norm": 1356.83447265625,
  "masked_accuracy": 0.6875,
  "full_model_accuracy": 0.82421875,
  "exact_match": 0.77734375,
  "kl_threshold": 0.1,
  "l1_threshold": 3500,
  "test_evaluation": {
    "test_kl": 0.21271913964301348,
    "test_kl_std": 0.01840011264248036,
    "test_loss": 0.21271913964301348,
    "test_masked_acc": 0.6976562514901161,
    "test_masked_acc_std": 0.07020390978199333,
    "test_full_acc": 0.7861328125,
    "test_full_acc_std": 0.04678335768360736,
    "test_exact_match": 0.7738281264901161,
    "test_exact_match_std": 0.06192977059008257,
    "test_logit_diff": 2.950389340519905,
    "test_logit_diff_std": 0.22326177834468075,
    "relative_sparsity": 91.32090761750405,
    "full_sparsity": 98.65997697812922,
    "num_active_components": 3213,
    "epoch": 176,
    "step": 176
  }
}