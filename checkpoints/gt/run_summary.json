{
  "run_name": "GT_20251023_012757",
  "timestamp": "20251023_012757",
  "optimal_conditions_met": false,
  "training_completed": true,
  "final_step": 480,
  "sparsity_stats": {
    "layer": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      1,
      1,
      1,
      1,
      1,
      1,
      1,
      1,
      1,
      1,
      1,
      1,
      2,
      2,
      2,
      2,
      2,
      2,
      2,
      2,
      2,
      2,
      2,
      2,
      3,
      3,
      3,
      3,
      3,
      3,
      3,
      3,
      3,
      3,
      3,
      3,
      4,
      4,
      4,
      4,
      4,
      4,
      4,
      4,
      4,
      4,
      4,
      4,
      5,
      5,
      5,
      5,
      5,
      5,
      5,
      5,
      5,
      5,
      5,
      5,
      6,
      6,
      6,
      6,
      6,
      6,
      6,
      6,
      6,
      6,
      6,
      6,
      7,
      7,
      7,
      7,
      7,
      7,
      7,
      7,
      7,
      7,
      7,
      7,
      8,
      8,
      8,
      8,
      8,
      8,
      8,
      8,
      8,
      8,
      8,
      8,
      9,
      9,
      9,
      9,
      9,
      9,
      9,
      9,
      9,
      9,
      9,
      9,
      10,
      10,
      10,
      10,
      10,
      10,
      10,
      10,
      10,
      10,
      10,
      10,
      11,
      11,
      11,
      11,
      11,
      11,
      11,
      11,
      11,
      11,
      11,
      11
    ],
    "head": [
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11
    ],
    "qk_sparsity": [
      0.96875,
      0.765625,
      0.96875,
      0.984375,
      0.984375,
      0.484375,
      0.96875,
      0.984375,
      0.984375,
      0.953125,
      1.0,
      0.9375,
      0.953125,
      1.0,
      1.0,
      1.0,
      0.96875,
      0.921875,
      0.984375,
      0.921875,
      1.0,
      0.90625,
      0.953125,
      0.9375,
      0.984375,
      0.890625,
      0.90625,
      0.96875,
      0.90625,
      0.96875,
      1.0,
      0.984375,
      0.921875,
      0.96875,
      0.96875,
      0.984375,
      0.890625,
      0.96875,
      0.890625,
      0.9375,
      0.921875,
      0.96875,
      0.953125,
      0.96875,
      0.984375,
      0.90625,
      0.984375,
      0.96875,
      0.953125,
      0.96875,
      0.96875,
      0.96875,
      0.71875,
      0.953125,
      0.984375,
      0.96875,
      0.953125,
      0.96875,
      0.859375,
      0.9375,
      0.921875,
      0.984375,
      0.953125,
      0.96875,
      0.953125,
      0.953125,
      0.984375,
      0.953125,
      0.9375,
      0.8125,
      0.984375,
      0.953125,
      0.984375,
      0.78125,
      0.9375,
      0.96875,
      0.96875,
      0.96875,
      0.90625,
      0.96875,
      0.96875,
      0.859375,
      0.890625,
      0.921875,
      0.984375,
      0.984375,
      0.984375,
      0.890625,
      0.984375,
      0.96875,
      0.890625,
      0.953125,
      0.96875,
      0.96875,
      0.703125,
      0.78125,
      1.0,
      0.84375,
      0.96875,
      0.953125,
      0.984375,
      0.96875,
      0.828125,
      0.984375,
      0.71875,
      0.921875,
      0.859375,
      0.71875,
      0.984375,
      0.71875,
      0.96875,
      0.96875,
      1.0,
      0.828125,
      0.984375,
      0.9375,
      0.984375,
      0.984375,
      0.984375,
      0.984375,
      1.0,
      1.0,
      0.75,
      1.0,
      0.90625,
      0.984375,
      1.0,
      0.90625,
      1.0,
      1.0,
      1.0,
      1.0,
      0.984375,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      0.921875,
      1.0,
      1.0,
      1.0
    ],
    "ov_sparsity": [
      0.9846153855323792,
      0.892307698726654,
      0.9692307710647583,
      0.9846153855323792,
      1.0,
      0.9538461565971375,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      0.9846153855323792,
      1.0,
      1.0,
      0.9538461565971375,
      1.0,
      0.9846153855323792,
      1.0,
      0.9538461565971375,
      0.9692307710647583,
      0.9230769276618958,
      0.9846153855323792,
      0.9846153855323792,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      0.9692307710647583,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      0.9846153855323792,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      0.9846153855323792,
      1.0,
      0.9692307710647583,
      1.0,
      1.0,
      1.0,
      0.9538461565971375,
      1.0,
      0.9692307710647583,
      0.9846153855323792,
      1.0,
      1.0,
      1.0,
      0.9076923131942749,
      0.9846153855323792,
      1.0,
      0.9846153855323792,
      0.9846153855323792,
      1.0,
      0.9692307710647583,
      1.0,
      0.5538461804389954,
      0.9692307710647583,
      1.0,
      1.0,
      0.9076923131942749,
      0.9538461565971375,
      1.0,
      1.0,
      0.7076923251152039,
      0.8769230842590332,
      1.0,
      1.0,
      0.9846153855323792,
      1.0,
      0.9384615421295166,
      1.0,
      1.0,
      0.9692307710647583,
      1.0,
      1.0,
      1.0,
      0.3384615480899811,
      0.7076923251152039,
      0.9538461565971375,
      0.800000011920929,
      1.0,
      0.9692307710647583,
      1.0,
      0.9692307710647583,
      0.7230769395828247,
      1.0,
      0.5384615659713745,
      0.9538461565971375,
      0.8307692408561707,
      0.446153849363327,
      1.0,
      0.0923076942563057,
      0.9846153855323792,
      0.9230769276618958,
      0.9384615421295166,
      0.7076923251152039,
      1.0,
      0.9076923131942749,
      1.0,
      1.0,
      1.0,
      1.0,
      0.9384615421295166,
      0.9384615421295166,
      0.446153849363327,
      0.9692307710647583,
      0.7538461685180664,
      0.8307692408561707,
      0.9846153855323792,
      0.6461538672447205,
      1.0,
      1.0,
      1.0,
      0.9846153855323792,
      0.9538461565971375,
      0.9692307710647583,
      0.8615384697914124,
      0.9846153855323792,
      0.9846153855323792,
      1.0,
      0.9692307710647583,
      0.9384615421295166,
      0.8461538553237915,
      0.9538461565971375,
      0.9230769276618958,
      0.9692307710647583
    ],
    "overall_sparsity": [
      0.9766826927661896,
      0.828966349363327,
      0.9689903855323792,
      0.9844951927661896,
      0.9921875,
      0.7191105782985687,
      0.984375,
      0.9921875,
      0.9921875,
      0.9765625,
      1.0,
      0.96875,
      0.9765625,
      0.9923076927661896,
      1.0,
      1.0,
      0.9612980782985687,
      0.9609375,
      0.9844951927661896,
      0.9609375,
      0.9769230782985687,
      0.9377403855323792,
      0.9381009638309479,
      0.9610576927661896,
      0.9844951927661896,
      0.9453125,
      0.953125,
      0.984375,
      0.953125,
      0.984375,
      1.0,
      0.9921875,
      0.9609375,
      0.984375,
      0.9689903855323792,
      0.9921875,
      0.9453125,
      0.984375,
      0.9453125,
      0.96875,
      0.9609375,
      0.9766826927661896,
      0.9765625,
      0.984375,
      0.9921875,
      0.953125,
      0.9921875,
      0.984375,
      0.9765625,
      0.984375,
      0.984375,
      0.984375,
      0.8516826927661896,
      0.9765625,
      0.9768028855323792,
      0.984375,
      0.9765625,
      0.984375,
      0.9066105782985687,
      0.96875,
      0.9455528855323792,
      0.9844951927661896,
      0.9765625,
      0.984375,
      0.9765625,
      0.9304086565971375,
      0.9844951927661896,
      0.9765625,
      0.9610576927661896,
      0.8985576927661896,
      0.9921875,
      0.9611778855323792,
      0.9921875,
      0.6675480902194977,
      0.9533653855323792,
      0.984375,
      0.984375,
      0.9382211565971375,
      0.9300480782985687,
      0.984375,
      0.984375,
      0.7835336625576019,
      0.8837740421295166,
      0.9609375,
      0.9921875,
      0.9844951927661896,
      0.9921875,
      0.9145432710647583,
      0.9921875,
      0.984375,
      0.9299278855323792,
      0.9765625,
      0.984375,
      0.984375,
      0.5207932740449905,
      0.7444711625576019,
      0.9769230782985687,
      0.8218750059604645,
      0.984375,
      0.9611778855323792,
      0.9921875,
      0.9689903855323792,
      0.7756009697914124,
      0.9921875,
      0.6286057829856873,
      0.9378605782985687,
      0.8450721204280853,
      0.5824519246816635,
      0.9921875,
      0.40552884712815285,
      0.9766826927661896,
      0.9459134638309479,
      0.9692307710647583,
      0.7679086625576019,
      0.9921875,
      0.9225961565971375,
      0.9921875,
      0.9921875,
      0.9921875,
      0.9921875,
      0.9692307710647583,
      0.9692307710647583,
      0.5980769246816635,
      0.9846153855323792,
      0.8300480842590332,
      0.9075721204280853,
      0.9923076927661896,
      0.7762019336223602,
      1.0,
      1.0,
      1.0,
      0.9923076927661896,
      0.9691105782985687,
      0.9846153855323792,
      0.9307692348957062,
      0.9923076927661896,
      0.9923076927661896,
      1.0,
      0.9846153855323792,
      0.9692307710647583,
      0.8840144276618958,
      0.9769230782985687,
      0.9615384638309479,
      0.9846153855323792
    ],
    "mlp_in_sparsity": [
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      0.9973992109298706,
      0.9986996054649353,
      0.9947984218597412,
      0.7880364060401917,
      0.7061118483543396,
      0.9401820302009583
    ],
    "mlp_out_sparsity": [
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      0.9986979365348816,
      0.9973958134651184,
      0.9869791865348816,
      0.84375,
      0.74609375,
      0.8893229365348816
    ],
    "total_sparsity": 0.9477579686655861
  },
  "sparsity_metrics": {
    "num_active_components": 1772,
    "relative_sparsity": 0.9521339816315505,
    "full_sparsity": 0.9926096458302054,
    "relative_sparsity_pct": 95.21339816315505,
    "full_sparsity_pct": 99.26096458302054,
    "relative_denominator": 37020,
    "full_denominator": 239772,
    "sparsity_threshold": 0.01
  },
  "hyperparameters": {
    "learning_rate": 0.01,
    "l1_weight": 0.00019,
    "weight_decay": 0.0,
    "batch_size": 64,
    "num_epochs": 15,
    "sparsity_threshold": 0.01
  },
  "config": {
    "experiment_name": "GT",
    "seed": 42,
    "use_wandb": true,
    "model": {
      "name": "gpt2-small",
      "pretrained_cache_dir": "cache_dir"
    },
    "data_type": "gt",
    "max_pad_length": 64,
    "training": {
      "batch_size": 64,
      "num_epochs": 15,
      "device": "cuda",
      "learning_rate": 0.01,
      "weight_decay": 0.0,
      "l1_weight": 0.00019,
      "temperature": 1.0,
      "eval_interval": 50,
      "patience": 5,
      "min_lr": "1e-6",
      "lr_factor": 0.5,
      "early_stopping": true,
      "save_checkpoints": true,
      "annealing_lambda_epochs": -1,
      "kl_opt": 0.1,
      "l1_opt": 3500,
      "validation_interval": 20
    },
    "masking": {
      "mask_init_value": 0.99,
      "cache_svd": true,
      "warmup_steps": 0,
      "max_iterations_per_batch": 15,
      "sparsity_threshold": 0.01,
      "sparsity": {
        "initial": 0.0,
        "target": 0.85,
        "increment": 0.01,
        "steps": 500
      },
      "regularization": {
        "kl_coefficient": 1.0
      }
    },
    "visualization": {
      "plot_interval": 100,
      "log_gradients": false,
      "save_visualizations": true,
      "visualization_dir": "visualizations"
    },
    "log_dir": "svd_circuit_logs_/\"gt\"_bayesopt",
    "run_dir": "svd_logs/GT_20251023_012757",
    "vis_dir": "svd_logs/GT_20251023_012757/visualizations"
  },
  "validation_kl": 0.22403995133936405,
  "validation_loss": 0.495454341173172,
  "l1_norm": 1428.4967041015625,
  "masked_accuracy": 0.0,
  "full_model_accuracy": 0.0,
  "exact_match": 0.35922476276755333,
  "kl_threshold": 0.1,
  "l1_threshold": 3500,
  "test_evaluation": {
    "test_kl": 0.23129201657138765,
    "test_kl_std": 0.02578856185714088,
    "test_loss": 0.23129201657138765,
    "test_masked_acc": 0.0,
    "test_masked_acc_std": 0.0,
    "test_full_acc": 0.0,
    "test_full_acc_std": 0.0,
    "test_exact_match": 0.33447265625,
    "test_exact_match_std": 0.06070745360243874,
    "test_logit_diff": 0.11600029732411106,
    "test_logit_diff_std": 0.10949394688191033,
    "relative_sparsity": 95.21339816315505,
    "full_sparsity": 99.26096458302054,
    "num_active_components": 1772,
    "epoch": 480,
    "step": 480
  }
}